<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ohgiraffers.crud.menu.model.dao.MenuMapper">

<!--    <resultMap id="menuResultMap" type="MenuDTO">-->
<!--        <id property="code" column="menu_code"/>-->
<!--        <result property="name" column="menu_name"/>-->
<!--        <result property="price" column="menu_price"/>-->
<!--        <result property="categoryCode" column="category_code"/>-->
<!--        <result property="orderableStatus" column="orderable_status"/>-->
<!--    </resultMap>-->

<!--    <resultMap id="categoryResultMap" type="CategoryDTO">-->
<!--        <id property="code" column="category_code"/>-->
<!--        <result property="name" column="category_name"/>-->
<!--        <result property="refCategoryCode" column="ref_category_code"/>-->
<!--    </resultMap>-->

    <select id="findAllMenu" resultType="MenuDTO">
        select
               menu_code
             , menu_name
             , menu_price
             , category_code
             , orderable_status
          from tbl_menu
         where orderable_status = 'Y'
         order by menu_code
    </select>

    <select id="findMenuByMenuCode" resultType="MenuDTO" parameterType="_int">
        select
        menu_code
        , menu_name
        , menu_price
        , category_code
        , orderable_status
        from tbl_menu
        where orderable_status = 'Y'
        and menu_code=#{menuCode)}
    </select>

    <select id="findAllCategory" resultType="CategoryDTO">
        select
               category_code
             , category_name
             , ref_category_code
          from tbl_category
    </select>

    <insert id="registNewMenu" parameterType="MenuDTO"
            useGeneratedKeys="true" keyProperty="code">
        insert into tbl_menu
        (
          menu_name
        , menu_price
        , category_code
        , orderable_status
        )
        values
        (
          #{ name }
        , #{ price }
        , #{ categoryCode }
        , #{ orderableStatus }
        )
    </insert>

    <update id="modifyMenu" parameterType="MenuDTO">
        UPDATE TBL_MENU
        SET
        MENU_NAME = #{menuName}
        , MENU_PRICE = #{price}
        , CATEGORY_CODE = #{code}
        , ORDERABLE_STATUS = 'Y'
        WHERE MENU_CODE = #{code}
    </update>

</mapper>